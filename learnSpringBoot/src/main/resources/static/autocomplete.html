<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì •ë ¬ ë° í˜ì´ì§• ê²€ìƒ‰</title>
    <style>
        input, select {
            padding: 8px;
            margin: 4px;
        }
        ul {
            list-style-type: none;
            padding-left: 0;
        }
        li {
            padding: 6px;
        }
    </style>
</head>
<body>
<h2>ğŸ“š ì •ë ¬ ë° í˜ì´ì§• ê²€ìƒ‰</h2>

<!-- ê²€ìƒ‰ì–´ ì…ë ¥ -->
<input id="keyword" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥">

<!-- ì •ë ¬ í•„ë“œ ì„ íƒ -->
<select id="sortBy">
    <option value="title">ì œëª©(title)</option>
    <option value="views">ì¡°íšŒìˆ˜(views)</option>
    <option value="createdAt">ì‘ì„±ì¼(createdAt)</option>
</select>

<!-- ì •ë ¬ ë°©í–¥ ì„ íƒ -->
<select id="direction">
    <option value="asc">ì˜¤ë¦„ì°¨ìˆœ(asc)</option>
    <option value="desc">ë‚´ë¦¼ì°¨ìˆœ(desc)</option>
</select>

<!-- í˜ì´ì§€ ë²ˆí˜¸ ë° ì‚¬ì´ì¦ˆ ì„¤ì • -->
<input id="page" type="number" value="0" min="0" style="width:60px" />
<input id="size" type="number" value="10" min="1" style="width:60px" />

<!-- ê²€ìƒ‰ ë²„íŠ¼ -->
<button onclick="pagedSearch()">ê²€ìƒ‰</button>

<!-- ê²°ê³¼ ì¶œë ¥ -->
<ul id="resultList"></ul>

<script>
    async function pagedSearch() {
        const keyword = document.getElementById("keyword").value;
        const sortBy = document.getElementById("sortBy").value;
        const direction = document.getElementById("direction").value;
        const page = document.getElementById("page").value;
        const size = document.getElementById("size").value;
        const resultList = document.getElementById("resultList");
        resultList.innerHTML = "";

        try {
            const res = await fetch(`/search/paged?keyword=${encodeURIComponent(keyword)}&sortBy=${sortBy}&direction=${direction}&page=${page}&size=${size}`);
            const data = await res.json();

            if (!Array.isArray(data)) {
                throw new Error("ì‘ë‹µì´ ë°°ì—´ì´ ì•„ë‹˜: " + JSON.stringify(data));
            }

            data.forEach(title => {
                const li = document.createElement("li");
                li.textContent = title;
                resultList.appendChild(li);
            });
        } catch (err) {
            const li = document.createElement("li");
            li.textContent = "ğŸ”´ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ";
            li.style.color = "red";
            resultList.appendChild(li);
            console.error(err);
        }
    }
</script>

</body>
</html>
