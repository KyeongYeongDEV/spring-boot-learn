<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì •ë ¬ ê²€ìƒ‰</title>
    <style>
        input, select {
            padding: 8px;
            margin: 4px;
        }
        ul {
            list-style-type: none;
            padding-left: 0;
        }
        li {
            padding: 6px;
        }
    </style>
</head>
<body>
<h2>ì •ë ¬ ê¸°ë°˜ ê²€ìƒ‰</h2>

<input id="keyword" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥">
<select id="sortBy">
    <option value="title">ì œëª©(title)</option>
    <option value="views">ì¡°íšŒìˆ˜(views)</option>
    <option value="createdAt">ì‘ì„±ì¼(createdAt)</option>
</select>
<select id="direction">
    <option value="asc">ì˜¤ë¦„ì°¨ìˆœ(asc)</option>
    <option value="desc">ë‚´ë¦¼ì°¨ìˆœ(desc)</option>
</select>
<button onclick="sortedSearch()">ê²€ìƒ‰</button>

<ul id="resultList"></ul>

<script>
    async function sortedSearch() {
        const keyword = document.getElementById("keyword").value;
        const sortBy = document.getElementById("sortBy").value;
        const direction = document.getElementById("direction").value;
        const resultList = document.getElementById("resultList");
        resultList.innerHTML = "";

        try {
            const res = await fetch(`/search/sorted?keyword=${encodeURIComponent(keyword)}&sortBy=${sortBy}&direction=${direction}`);
            const data = await res.json();

            if (!Array.isArray(data)) {
                throw new Error("ì‘ë‹µì´ ë°°ì—´ì´ ì•„ë‹˜: " + JSON.stringify(data));
            }

            data.forEach(title => {
                const li = document.createElement("li");
                li.textContent = title;
                resultList.appendChild(li);
            });
        } catch (err) {
            const li = document.createElement("li");
            li.textContent = "ğŸ”´ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ ë°œìƒ";
            li.style.color = "red";
            resultList.appendChild(li);
            console.error(err);
        }
    }
</script>

</body>
</html>
